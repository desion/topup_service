/*************************************************************************
	> File Name: BaseBusiness.cpp
	> Author: desionwang
	> Mail: wdxin1322@qq.com 
	> Created Time: Wed 15 Jan 2014 07:38:57 PM CST
 ************************************************************************/

#include<iostream>
#include<exception>
#include "BaseBusiness.h"
using namespace std;

void BaseBusiness::HandleException(std::exception &e){
	errors.push_back("Exception");
	LOG(ERROR) << e.what();
}

void BaseBusiness::Finish(){
    try{
	    if(conn != NULL){
			if(errors.empty()){
				conn->commit();	
			}else{
				conn->rollback();
			}
		}
	}catch(SQLException &sqlExcp){
	    LOG(ERROR) << sqlExcp.getMessage();
	}
	if(conn != NULL){
		dcm->Recover(conn);
	}
}

void BaseBusiness::Init(){
	conn = dcm->CreateConnection();
}
